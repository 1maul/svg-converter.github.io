<!DOCTYPE html>
<html lang="en">
<head>
    <!-- [Previous head content remains the same] -->
</head>
<body>
    <!-- [Previous container content remains the same until the script] -->

    <script>
        // [Previous JavaScript remains the same until the optimizeSVG function]

        function optimizeSVG(content, color) {
            // Set fixed canvas size
            const viewBox = 'viewBox="0 0 380 600"';
            const width = 'width="380"';
            const height = 'height="600"';
            
            // Extract and preserve necessary namespaces
            const xmlns = 'xmlns="http://www.w3.org/2000/svg"';
            const xmlnsXlink = 'xmlns:xlink="http://www.w3.org/1999/xlink"';
            
            // Clean the SVG content more thoroughly
            const cleaned = content
                .replace(/<\?xml[\s\S]*?\?>|<!DOCTYPE[\s\S]*?>/, '')
                .replace(/<metadata>[\s\S]*?<\/metadata>/, '')
                .replace(/<style[^>]*>[\s\S]*?<\/style>/, '') // Remove existing styles
                .replace(/\s(id|class|style|xlink:href|xml:space)="[^"]*"/g, '')
                .replace(/<image[\s\S]*?>|<\/image>/g, '');
            
            // Create the processed SVG with internal CSS
            return `<?xml version="1.0" encoding="UTF-8"?>
<svg ${xmlns} ${xmlnsXlink} ${viewBox} ${width} ${height}>
  <defs>
    <style type="text/css">
      <![CDATA[
        .cls-1 { fill: ${color}; }
      ]]>
    </style>
  </defs>
  ${cleaned
    .replace(/<svg[\s\S]*?>|<\/svg>/g, '')
    .replace(/<path/g, '<path class="cls-1"')
  }
</svg>`;
        }
    </script>
</body>
</html>
